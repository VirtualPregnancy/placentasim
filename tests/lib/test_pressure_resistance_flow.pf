!******************************************************

@Test
  subroutine test_prf_inlet_pressure()
    use pfunit_mod
    use arrays, only: dp,elem_field,node_field,num_elems
    use indices, only: ne_Qdot,num_ne
    use pressure_resistance_flow, only: evaluate_prq
    implicit none

    character(LEN=60) :: mesh_type, bc_type
    real(dp) :: inlet_flow
    real(dp) :: test_elem_field(num_ne,8) !(num_ne: num_elems)
   
    mesh_type = "full_plus_tube"
    bc_type = "pressure"
    inlet_flow = 0.0_dp
    call evaluate_prq(mesh_type,bc_type,inlet_flow)
      
    !populate test data
    call inlet_pressure_set_flow(test_elem_field) 
    !resistance
    !total_resistance
    
    print *,"ne_Qdot",ne_Qdot
    
    !check flow
    @assertEqual(test_elem_field(ne_Qdot,1:8),elem_field(ne_Qdot,1:num_elems)) 
    !check pressure

  end subroutine test_prf_inlet_pressure

!subroutines to populate test data

  subroutine inlet_pressure_set_flow(elem_field)
    use arrays, only: dp
    use indices, only: ne_Qdot,num_ne
    implicit none
    real(dp),intent(out) :: elem_field(num_ne,8) !(num_ne : num_elems)
    
    elem_field = 0.0_dp
    elem_field(ne_Qdot,1) = 37222.234024570418_dp    
    elem_field(ne_Qdot,2) = 18611.117012285209_dp     
    elem_field(ne_Qdot,3) = 18611.117012285209_dp     
    elem_field(ne_Qdot,4) = 37222.234024570418_dp     
    elem_field(ne_Qdot,5) = 18611.117012285209_dp     
    elem_field(ne_Qdot,6) = 18611.117012285209_dp     
    elem_field(ne_Qdot,7) = 18611.117012285209_dp     
    elem_field(ne_Qdot,8) = 18611.117012285209_dp     

  end subroutine inlet_pressure_set_flow

  subroutine inlet_pressure_set_pressure(node_field)
    use arrays, only: dp
    use indices, only: nj_bv_press,num_nj
    implicit none
    real(dp),intent(out) :: node_field(num_nj,8) !(num_nj : num_nodes)
  
    node_field(nj_bv_press,1) = 1995.0000000000000_dp     
    node_field(nj_bv_press,2) = 1601.8151160292209_dp     
    node_field(nj_bv_press,3) = 819.94485316332521_dp     
    node_field(nj_bv_press,4) = 819.94485316332521_dp     
    node_field(nj_bv_press,5) = 665.00000000000000_dp     
    node_field(nj_bv_press,6) = 715.95676076591155_dp     
    node_field(nj_bv_press,7) = 819.94485168899269_dp     
    node_field(nj_bv_press,8) = 819.94485168899269_dp     
                           
  end subroutine inlet_pressure_set_pressure               
                                  
 !flow unit_field(nu_perf,           1 )=   18611.117012285209     
 !pressure unit_field(nu_blood_press,           1 )=   819.94485316332521     
 !flow unit_field(nu_perf,           2 )=   18611.117012285209     
 !pressure unit_field(nu_blood_press,           2 )=   819.94485316332521     

 
!call it again with inlet flow



!************************************************* 
  
@Test  
  subroutine test_prf_inlet_flow()
    use pfunit_mod
    use arrays, only: dp,elem_field,node_field,num_elems
    use indices, only: ne_Qdot,num_ne
    use pressure_resistance_flow, only: evaluate_prq
    implicit none

    character(LEN=60) :: mesh_type, bc_type
    real(dp) :: inlet_flow
    real(dp) :: test_elem_field(num_ne,8) !(num_ne: num_elems)
   
    mesh_type = "full_plus_tube"
    bc_type = "flow"
    inlet_flow = 37222.0_dp
    call evaluate_prq(mesh_type,bc_type,inlet_flow)
      
    !populate test data
    call inlet_flow_set_flow(test_elem_field) 
    !resistance
    !total_resistance
    
    !check flow
    @assertEqual(test_elem_field(ne_Qdot,1:8),elem_field(ne_Qdot,1:num_elems)) 
    !check pressure

  end subroutine test_prf_inlet_flow   
  
  subroutine inlet_flow_set_flow(elem_field)
    use arrays, only: dp
    use indices, only: ne_Qdot,num_ne
    implicit none
    real(dp),intent(out) :: elem_field(num_ne,8) !(num_ne : num_elems)
    
    elem_field = 0.0_dp
    elem_field(ne_Qdot,1) = 37222.234024570418_dp    
    elem_field(ne_Qdot,2) = 18611.117012285209_dp     
    elem_field(ne_Qdot,3) = 18611.117012285209_dp     
    elem_field(ne_Qdot,4) = 37222.234024570418_dp     
    elem_field(ne_Qdot,5) = 18611.117012285209_dp     
    elem_field(ne_Qdot,6) = 18611.117012285209_dp     
    elem_field(ne_Qdot,7) = 18611.117012285209_dp     
    elem_field(ne_Qdot,8) = 18611.117012285209_dp     

  end subroutine inlet_flow_set_flow          